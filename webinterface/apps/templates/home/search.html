{% extends "layouts/base.html" %} {% block title %} Page Blank {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %} {% block content %}

<div class="row">
    <div class="col-md-12">
        <div class="card card-profile">
            <div class="card-body">

                <h4 class="card-title">Target specific IP</h4>
                <div class="row">

                    <div class="col-md-3 px-md-1">
                        <div class="form-group">
                            <form action="/search" method="post">
                                <p><input class="form-control" type="text" name="search" value="127.0.0.1" /></p>
                                <p><input class="btn btn-primary btn-round" type="submit" value="submit" /></p>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="card card-profile">
            <div class="card-body">
                <table>
                    <tr><td>
                        <h4 class="card-title"> {{ip}} </h4>
                    </td>
                    <td>
                        <img src="./webinterface/apps/static/assets/img/countryflagdummy.png" id="img-country"/>
                    </td>
                </tr>
                </table>
                <div class="row">

                    <div class="col-md-3 px-md-1"> 
                        <div>
                            <p style="padding: 0 15px"> IP = {{ip}}</p>
                            <p style="padding: 0 15px"> ASN = {{asn}}</p>
                            <p style="padding: 0 15px" id = 'bad'> VPN = {{bad}}</p>
                        </div>
                        <div>
                            <div class="card" id="alert-container">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="card card-profile">
            <div class="card-body">

                <h4 class="card-title">Map</h4>
                <div class="row">

                    <div class="col-md-3 px-md-1">
                        <!-- sample -->
                        <style>
                            #chartdiv {
                              width: 100%;
                              height: 500px;
                            }
                            </style>
                            <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
                            <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
                            <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
                            <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
                            <script>
                                am5.ready(function() {

                            // Create root element
                            // https://www.amcharts.com/docs/v5/getting-started/#Root_element
                            var root = am5.Root.new("chartdiv");


                            // Set themes
                            // https://www.amcharts.com/docs/v5/concepts/themes/
                            root.setThemes([
                            am5themes_Animated.new(root)
                            ]);


                            // Create the map chart
                            // https://www.amcharts.com/docs/v5/charts/map-chart/
                            var chart = root.container.children.push(am5map.MapChart.new(root, {
                            panX: "translateX",
                            panY: "translateY",
                            projection: am5map.geoMercator()
                            }));

                            var cont = chart.children.push(am5.Container.new(root, {
                            layout: root.horizontalLayout,
                            x: 20,
                            y: 40
                            }));


                            // Add labels and controls
                            cont.children.push(am5.Label.new(root, {
                            centerY: am5.p50,
                            text: "Map"
                            }));

                            var switchButton = cont.children.push(am5.Button.new(root, {
                            themeTags: ["switch"],
                            centerY: am5.p50,
                            icon: am5.Circle.new(root, {
                                themeTags: ["icon"]
                            })
                            }));

                            switchButton.on("active", function() {
                            if (!switchButton.get("active")) {
                                chart.set("projection", am5map.geoMercator());
                                chart.set("panX", "translateX");
                                chart.set("panY", "translateY");
                            }
                            else {
                                chart.set("projection", am5map.geoOrthographic());
                                chart.set("panX", "rotateX");
                                chart.set("panY", "rotateY");
                            }
                            });

                            cont.children.push(am5.Label.new(root, {
                            centerY: am5.p50,
                            text: "Globe"
                            }));

                            // Create main polygon series for countries
                            // https://www.amcharts.com/docs/v5/charts/map-chart/map-polygon-series/
                            var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {
                            geoJSON: am5geodata_worldLow
                            }));

                            var graticuleSeries = chart.series.push(am5map.GraticuleSeries.new(root, {}));
                            graticuleSeries.mapLines.template.setAll({
                            stroke: root.interfaceColors.get("alternativeBackground"),
                            strokeOpacity: 0.08
                            });

                            // Create line series for trajectory lines
                            // https://www.amcharts.com/docs/v5/charts/map-chart/map-line-series/
                            var lineSeries = chart.series.push(am5map.MapLineSeries.new(root, {}));
                            lineSeries.mapLines.template.setAll({
                            stroke: root.interfaceColors.get("alternativeBackground"),
                            strokeOpacity: 0.6
                            });

                            // destination series
                            var citySeries = chart.series.push(
                            am5map.MapPointSeries.new(root, {})
                            );

                            citySeries.bullets.push(function() {
                            var circle = am5.Circle.new(root, {
                                radius: 5,
                                tooltipText: "{title}",
                                tooltipY: 0,
                                fill: am5.color(0xffba00),
                                stroke: root.interfaceColors.get("background"),
                                strokeWidth: 2
                            });

                            return am5.Bullet.new(root, {
                                sprite: circle
                            });
                            });

                            // arrow series
                            var arrowSeries = chart.series.push(
                            am5map.MapPointSeries.new(root, {})
                            );

                            arrowSeries.bullets.push(function() {
                            var arrow = am5.Graphics.new(root, {
                                fill: am5.color(0x000000),
                                stroke: am5.color(0x000000),
                                draw: function (display) {
                                display.moveTo(0, -3);
                                display.lineTo(8, 0);
                                display.lineTo(0, 3);
                                display.lineTo(0, -3);
                                }
                            });

                            return am5.Bullet.new(root, {
                                sprite: arrow
                            });
                            });
                            var cities =[];
                            //sample format
                            // var cities = [
                            // {
                            //     id: "london",
                            //     title: "London",
                            //     geometry: { type: "Point", coordinates: [-0.1262, 51.5002] },
                            // },
      
                      
                            citySeries.data.setAll(cities);

                            // prepare line series data
                            var destinations = ["reykjavik", "lisbon", "moscow", "belgrade", "ljublana", "madrid", "stockholm", "bern", "kiev", "new york"];
                            // London coordinates
                            var originLongitude = -0.1262;
                            var originLatitude = 51.5002;

                            am5.array.each(destinations, function (did) {
                            var destinationDataItem = citySeries.getDataItemById(did);
                            var lineDataItem = lineSeries.pushDataItem({ geometry: { type: "LineString", coordinates: [[originLongitude, originLatitude], [destinationDataItem.get("longitude"), destinationDataItem.get("latitude")]] } });

                            arrowSeries.pushDataItem({
                                lineDataItem: lineDataItem,
                                positionOnLine: 0.5,
                                autoRotate: true
                            });
                            })

                            polygonSeries.events.on("datavalidated", function () {
                            chart.zoomToGeoPoint({ longitude: -0.1262, latitude: 51.5002 }, 3);
                            })


                            // Make stuff animate on load
                            chart.appear(1000, 100);
                        });
                     </script>
                            <div id="chartdiv"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="card card-profile">
            <div class="card-body">

                <h4 class="card-title">result</h4>
                <div class="row">

                    <div class="col-md-3 px-md-1">

                        <h1>result</h1>



                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    document.write(`
        {{result}}
        `)
</script>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script type="text/javascript">
    function notif() {
        var text = "{{bad}}";
        if(text == 'False'){
            var notVpn = "This is not a VPN";
            document.getElementById("alert-container").innerHTML = `<div class="alert"><div class="alert-success"><button type="button" aria-hidden="true" class="close" data-dismiss="alert" aria-label="Close"> <i class="tim-icons icon-simple-remove"></i> </button> <span><b> <h3 class="text-muted"> ${notVpn}  </h3> </b></span></div></div>`; 
        }
        else if(text == 'True'){
            var isVPN = "This is a VPN";
            document.getElementById("alert-container").innerHTML = `<div class="alert"><div class="alert-warning"><button type="button" aria-hidden="true" class="close" data-dismiss="alert" aria-label="Close"> <i class="tim-icons icon-simple-remove"></i> </button> <span><b> <h3 class = "text-muted"> ${isVPN} </h3> </b></span></div></div>`; 
        }
    }
    notif();
</script>
{% endblock javascripts %}